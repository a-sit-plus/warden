import at.asitplus.attestation.WardenDebugAttestationStatement
import at.asitplus.attestation.decodeBase64ToArray
import at.asitplus.attestation.parseToPublicKey
import at.asitplus.io.multibaseDecode
import at.asitplus.signum.indispensable.CryptoPublicKey
import at.asitplus.signum.indispensable.fromJcaPublicKey
import at.asitplus.signum.indispensable.toCryptoPublicKey
import io.kotest.core.spec.style.FreeSpec
import io.kotest.matchers.shouldBe
import java.security.interfaces.ECPublicKey

class KeyConversionTests : FreeSpec({

    "ReplayTest" {
       val statement=  WardenDebugAttestationStatement.deserialize("MeyJhbmRyb2lkQXR0ZXN0YXRpb25Db25maWd1cmF0aW9uIjp7ImFwcGxpY2F0aW9ucyI6W3sicGFja2FnZU5hbWUiOiJhdC5hc2l0cGx1cy5kaWdpdGFsaWQud2FsbGV0LnB1cGlsaWQiLCJzaWduYXR1cmVEaWdlc3RzIjpbIjVVR29vRFMyOVVoZVhMeXoxMnJsVGJCMzZ2XzM5Nm1ucnB5Y3BHeDBxbEkiLCJqNEtuNFB1c0F5aFRVRTMwV0cxQWJWRGZDa2w3U3Y4YThJWVlHcXN6eXg4Il0sImFwcFZlcnNpb24iOm51bGwsImFuZHJvaWRWZXJzaW9uT3ZlcnJpZGUiOm51bGwsInBhdGNoTGV2ZWxPdmVycmlkZSI6bnVsbCwib3NQYXRjaExldmVsIjpudWxsfV0sImFuZHJvaWRWZXJzaW9uIjo5MDAwMCwicGF0Y2hMZXZlbCI6eyJ5ZWFyIjoyMDIwLCJtb250aCI6MX0sInJlcXVpcmVTdHJvbmdCb3giOmZhbHNlLCJhbGxvd0Jvb3Rsb2FkZXJVbmxvY2siOmZhbHNlLCJyZXF1aXJlUm9sbGJhY2tSZXNpc3RhbmNlIjpmYWxzZSwiaWdub3JlTGVhZlZhbGlkaXR5IjpmYWxzZSwiaGFyZHdhcmVBdHRlc3RhdGlvblRydXN0QW5jaG9ycyI6WyItLS0tLUJFR0lOIFBVQkxJQyBLRVktLS0tLVxuTUlJQ0lqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FnOEFNSUlDQ2dLQ0FnRUFyN2JIZ2l1eHB3SHNLN1F1aTh4VVxuRm1Pcjc1Z3ZNc2QvZFRFRERKZFNTeHRmNkFuN3h5cXBSUjkwUEwyYWJ4TTFkRXFsWG5mMnRxdzFOZTRYd2w1alxubFJmZG5KTG1OMHBUeS80bGo0Lzd0djBTazNpaUtreXBuRVV0UjZXZk1nSDBRWmZLSE0xK2RpK3k5VEZSdHY2eVxuLy8wcmIrVCtXOGE5bnNOTC9nZ2puYXI4NjQ2MXFPMHJPczJjWGpwM2tPRzFGRUo1TVZtRm1CR3RucktwYTczWFxucFh5VHFSeEIvTTBuMW4vVzluR3FDNEZTWWEwNFQ2TjVSSVpHQk4yejJNVDVJS0diRmxiQzhVclcwRHhXN0FZSVxubVFRY0h0R2wvbTAwUUxWV3V0SFFvVkpZbkZQbFhUY0hZdkFTTHUrUmhoc2JEbXhNZ0pKMG1jRHB2c0M0UGp2QlxuK1R4eXdFbGdTNzB2RTBYbUxEK09KdHZzQnNsSFp2UEJLQ09kVDBNUyt0Z1NPSWZnYSt6MVoxZzcrRFZhZ2Y3cVxudXZtYWc4amZQaW95S3Z4bksvRWdzVFVWaTJnaHpxOHdtMjd1ZC9tSU03QVkycUVPUlI4R28zVFZCNEh6V1FncFxuWnJ0M2k1TUlsQ2FZNTA0THpTUmlpZ0hDekFQbEh3cytXMHJCNU4rZXI1LzJwSktuZkJTRGlDaUZBVnRDTE9aN1xuZ0xpTW0wamhPMkI2dFVYSEkvK01SUGp5MDJpNTlsSU5NUlJldjU2R0t0Y2Q5cU8vMGtVSldkWlRkQTJYb1M4MlxuaXhQdlp0WFFwVXB1TDEyYWIrOUVhREs4WjRSSEpZWWZDVDNRNXZOQVhhaVdRKzhQVFdtMlFnQlIvYmt3U1djK1xuTnBVRmdOUE45UHZRaThXRWc1VW1BR01DQXdFQUFRPT1cbi0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLSJdLCJzb2Z0d2FyZUF0dGVzdGF0aW9uVHJ1c3RBbmNob3JzIjpbIi0tLS0tQkVHSU4gUFVCTElDIEtFWS0tLS0tXG5NRmt3RXdZSEtvWkl6ajBDQVFZSUtvWkl6ajBEQVFjRFFnQUU3bDFleCtIQTIyMERwbjdtdGh2c1RXcGRhbWd1XG5ELzkvU1E1OWR4OUVJbTI5c2EvNkZzdkhyY1YzMGxhY3FyZXdMVlFCWFQ1REt5cU8xMDdzU0hWQnBBPT1cbi0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLSIsIi0tLS0tQkVHSU4gUFVCTElDIEtFWS0tLS0tXG5NSUdmTUEwR0NTcUdTSWIzRFFFQkFRVUFBNEdOQURDQmlRS0JnUUNpYTYzcmJpNUVZZS9WRG9MbXQ1VFJkU01mXG5kNXRqa1dQLzk2ci9DM0pIVHNBc1Erd3pmTmVzN1VBK2pDaWdadFgzaHdzemw5NE91RTRUUUt1dnBTZS9sV21nXG5NZHNHVW1YNFJGbFhZZkM3OGhkTHQwR0FaTUFvRG85U2Q0N2Iwa2UyUmVrWnlPbUx3OXZDa1QvWDExREVIVFZtXG4rVmZrbDVZTENhek9raldGbXdJREFRQUJcbi0tLS0tRU5EIFBVQkxJQyBLRVktLS0tLSJdLCJ2ZXJpZmljYXRpb25TZWNvbmRzT2Zmc2V0IjowLCJhdHRlc3RhdGlvblN0YXRlbWVudFZhbGlkaXR5U2Vjb25kcyI6ODY3MDAsImRpc2FibGVIYXJkd2FyZUF0dGVzdGF0aW9uIjpmYWxzZSwiZW5hYmxlTm91Z2F0QXR0ZXN0YXRpb24iOmZhbHNlLCJlbmFibGVTb2Z0d2FyZUF0dGVzdGF0aW9uIjpmYWxzZSwiaHR0cFByb3h5IjpudWxsLCJvc1BhdGNoTGV2ZWwiOjIwMjAwMX0sImlvc0F0dGVzdGF0aW9uQ29uZmlndXJhdGlvbiI6eyJhcHBsaWNhdGlvbnMiOlt7InRlYW1JZGVudGlmaWVyIjoiM1lZUFA0QjM2TiIsImJ1bmRsZUlkZW50aWZpZXIiOiJhdC5ndi5ibWJ3Zi5lZHVEaWdpY2FyZFdhbGxldCIsInNhbmRib3giOmZhbHNlLCJpb3NWZXJzaW9uT3ZlcnJpZGUiOm51bGx9XSwiaW9zVmVyc2lvbiI6eyJzZW1WZXIiOiIxNS4wIiwiYnVpbGROdW1iZXIiOiIxOUEzNDYifSwiYXR0ZXN0YXRpb25TdGF0ZW1lbnRWYWxpZGl0eVNlY29uZHMiOjg2NzAwfSwiZ2VuZXJpY0F0dGVzdGF0aW9uUHJvb2YiOlsiTUlJQ3RUQ0NBbHFnQXdJQkFnSUJBVEFLQmdncWhrak9QUVFEQWpBcE1Sa3dGd1lEVlFRRkV4QmhZbUZpTm1Zd1ptUXpOVGM0TkdRNU1Rd3dDZ1lEVlFRTURBTlVSVVV3SUJjTk56QXdNVEF4TURBd01EQXdXaGdQTWpFd05qQXlNRGN3TmpJNE1UVmFNQjh4SFRBYkJnTlZCQU1NRkVGdVpISnZhV1FnUzJWNWMzUnZjbVVnUzJWNU1Ga3dFd1lIS29aSXpqMENBUVlJS29aSXpqMERBUWNEUWdBRWZxNlhKVlZBMmJiSkpnSWsyOEt4R3l5QS1neG1lQUpLQjdNdW5CSU9QV0lQSVBEZDVmZ2Z3V1NBSnVLMGg3czdEYjk2VWNxeGVPeVJXeUtHWG5DcmRLT0NBWGt3Z2dGMU1BNEdBMVVkRHdFQl93UUVBd0lIZ0RDQ0FXRUdDaXNHQVFRQjFua0NBUkVFZ2dGUk1JSUJUUUlCQXdvQkFRSUJCQW9CQVFRZzB1TDJJb0V3R2FvSTdtai1PUnNrTUtmWkJFMDkyWktMRjVrNzVGVEozenNFQURCbHY0VTlDQUlHQVpaNzR2cDR2NFZGVlFSVE1GRXhLekFwQkNSaGRDNWhjMmwwY0d4MWN5NWthV2RwZEdGc2FXUXVkMkZzYkdWMExuQjFjR2xzYVdRQ0FRMHhJZ1FnajRLbjRQdXNBeWhUVUUzMFdHMUFiVkRmQ2tsN1N2OGE4SVlZR3Fzenl4OHdnYk9oQ0RFR0FnRUNBZ0VEb2dNQ0FRT2pCQUlDQVFDbEN6RUpBZ0VFQWdFQ0FnRUFxZ01DQVFHX2czZ0RBZ0VEdjRONUJBSUNBU3lfaFQ0REFnRUF2NFZBVERCS0JDRGhQLUdZaWU4elRSRlVmSVJLU3VJRmU0a2plYWtBNk12Ul9oWEpBYjVrMXdFQl93b0JBQVFnV3VZeDdSeVpOdVhxWk1oVVFaNzMwVkN6RjNtSmRieDlsUDVFUW1mYTZzS19oVUVGQWdNQnJiQ19oVUlGQWdNREZYLV9oVTRHQWdRQk5HV2R2NFZQQmdJRUFUUmxuVEFLQmdncWhrak9QUVFEQWdOSkFEQkdBaUVBOWRMVmw2TFJLSU9zdmNFNDBiQkxBUjZKdjNOMFNVZFZFdEpxRUxlS1QySUNJUUM1UmRieGRoeUQ1MHZxekx4S21TeEdBcU81NkhzM2ROMi1XcDZxSXZsQmxnIiwiTUlJQ0pUQ0NBYXVnQXdJQkFnSUtBaElUaFRtU2dFaVNWVEFLQmdncWhrak9QUVFEQWpBcE1Sa3dGd1lEVlFRRkV4QmhNV1EyTmpnNE1EQTROelV4TVRFNU1Rd3dDZ1lEVlFRTURBTlVSVVV3SGhjTk1UZ3dOREU0TWpJMU9EVXdXaGNOTWpnd05ERTFNakkxT0RVd1dqQXBNUmt3RndZRFZRUUZFeEJoWW1GaU5tWXdabVF6TlRjNE5HUTVNUXd3Q2dZRFZRUU1EQU5VUlVVd1dUQVRCZ2NxaGtqT1BRSUJCZ2dxaGtqT1BRTUJCd05DQUFTZHZPWU0zWUtBNFVJbWp2RW1MRzNPU0lSQjRxaWZoZFFmdnlsbVk0OXdPd1NCQ0xrSHZaVW1vTVJxeXdURzUzSEJUQ0g2UE9KNUhnUlM1NzZWekxnZm80RzZNSUczTUIwR0ExVWREZ1FXQkJSUFZRY0xFRlNpOU5vME1Td3k3OWJab0FlRzJqQWZCZ05WSFNNRUdEQVdnQlNPaW1DVGNLREc2aE95YXFWaXdvUXhVeGNZOWpBUEJnTlZIUk1CQWY4RUJUQURBUUhfTUE0R0ExVWREd0VCX3dRRUF3SUNCREJVQmdOVkhSOEVUVEJMTUVtZ1I2QkZoa05vZEhSd2N6b3ZMMkZ1WkhKdmFXUXVaMjl2WjJ4bFlYQnBjeTVqYjIwdllYUjBaWE4wWVhScGIyNHZZM0pzTHpBeU1USXhNemcxTXprNU1qZ3dORGc1TWpVMU1Bb0dDQ3FHU000OUJBTUNBMmdBTUdVQ01RQ2REVEp6emtsM0Z6NGdhRmNsZG1IbzdpSlh2WV9oZjBNQzFOV1NDdW9ySF84eTBuVXYyRFpGcnB2OUZWUG5Xb0FDTUZxR2pFbk1JR1A1ZUZGeUluZUlzSE50UExPVUpUZzVDa0h1YUhMaFJ2aXBNM0J3T0lyYThsRThuUXVjb1NoeW5BIiwiTUlJRDBUQ0NBYm1nQXdJQkFnSUtBNGdtWjJCbGlaYUZsVEFOQmdrcWhraUc5dzBCQVFzRkFEQWJNUmt3RndZRFZRUUZFeEJtT1RJd01EbGxPRFV6WWpaaU1EUTFNQjRYRFRFNE1EUXhPREl5TkRFMU5sb1hEVEk0TURReE5USXlOREUxTmxvd0tURVpNQmNHQTFVRUJSTVFZVEZrTmpZNE9EQXdPRGMxTVRFeE9URU1NQW9HQTFVRURBd0RWRVZGTUhZd0VBWUhLb1pJemowQ0FRWUZLNEVFQUNJRFlnQUVJaXl4Y0J1UXhaTkgtUUhOTDVZMG9wLUZrMDFNckpJYTVKVUdma0FSV3FOV0RhT0F3RTVDUVl1c1VSWExIWjhmbVdHVFhhSGNKekxmYlJZVVFSTV9lUG8zaVhXYnNnRG56MXlMYnBQSjNXaUJVQkFkVnk0MUlzemdfOTEzZHZsbm80RzJNSUd6TUIwR0ExVWREZ1FXQkJTT2ltQ1RjS0RHNmhPeWFxVml3b1F4VXhjWTlqQWZCZ05WSFNNRUdEQVdnQlEyWWVFQWZJZ0ZDVkdMUkd4SF94cE15ZXBQRWpBUEJnTlZIUk1CQWY4RUJUQURBUUhfTUE0R0ExVWREd0VCX3dRRUF3SUNCREJRQmdOVkhSOEVTVEJITUVXZ1E2QkJoajlvZEhSd2N6b3ZMMkZ1WkhKdmFXUXVaMjl2WjJ4bFlYQnBjeTVqYjIwdllYUjBaWE4wWVhScGIyNHZZM0pzTDBVNFJrRXhPVFl6TVRSRU1rWkJNVGd3RFFZSktvWklodmNOQVFFTEJRQURnZ0lCQUJ4U1dfTXZPRzd4NzdEY2xjSXpwODc5OWI2TDFHaWs4a1ByWHJVdVo4dlRNaU5HUElIU2lFRG83QlRGWG9HVkRlU1F0WGQ1WlhlWnFZV3lZaUcyTUNCRmtqUlRIakhjNGs2Qy1QbnRtNkJselFGdkF2bVlyT3hJcjUyRVhuVi1faDRGOWw3Y3ZFYUI1VEFKZFZGd0p0TENtc0J4U2c2VkJaWk41ZEZtdS02RjJsQVUxUkQ4TUE3ZkhjanJZck55MWlPNkJTaERvaEZsSFE5SDZCR25DalFDWG1SUzRXdEZmSURlNUs5VmZXc2xOTjUwaE4zQldsSmxmNHFnNXM4ZmZKVzNjRkg3cjFyc1IwUm5RQWJlekstb0RRcmdHcC1rLUM2MC1YT3FsbHl4bzRueDkyc0VMMUZHWWVMdDVGd0V3OU90ODg0ejVXSHdkQ1FyREhSOGsyeTllUUpON3Z5VVZUdkd4MW94VFlvT2IwSnZwQnl1LUNGdTc0ZUd3d3p1WklKS2FfRlBtUWJMbUFkUS1TZ2ZTT1FXbnBnNmxBU0hJaFRVYlpoNEVvbmgzMW5GRVBxUWpLNWllTlVJUXM5QVRpZ19RbzRpME9LNDhqeFVmZVg1WmxqNDR2Z2dRSXNRaHNzSFBOQmdGbXNMdzlnREt2SUt5YzR0Qm0wT01aNFBPVmVWc0xiX3VrWEJaUDZCN2t5MUtBb19TNzJlMldUdDhKdVlFOTRXZ19qLUNLS1RkY2JDR3NUZFBrU2FFLThrQ3hDUWFuVTB4Y1RaTmR0bTFfLUJqaW5CR2xIZ3otcG1kVVNWb0laYmdySDhjQ3pOTDdCQV81d1VhMV9uNnFXZTEybWdVNTJBdzF6QjQ2b0FqZGt4QUk1bnE2dDEySFlWbm4tT2NNS1hrV1RaIiwiTUlJRllEQ0NBMGlnQXdJQkFnSUpBT2o2R1dNVTB2b1lNQTBHQ1NxR1NJYjNEUUVCQ3dVQU1Cc3hHVEFYQmdOVkJBVVRFR1k1TWpBd09XVTROVE5pTm1Jd05EVXdIaGNOTVRZd05USTJNVFl5T0RVeVdoY05Nall3TlRJME1UWXlPRFV5V2pBYk1Sa3dGd1lEVlFRRkV4Qm1PVEl3TURsbE9EVXpZalppTURRMU1JSUNJakFOQmdrcWhraUc5dzBCQVFFRkFBT0NBZzhBTUlJQ0NnS0NBZ0VBcjdiSGdpdXhwd0hzSzdRdWk4eFVGbU9yNzVndk1zZF9kVEVEREpkU1N4dGY2QW43eHlxcFJSOTBQTDJhYnhNMWRFcWxYbmYydHF3MU5lNFh3bDVqbFJmZG5KTG1OMHBUeV80bGo0Xzd0djBTazNpaUtreXBuRVV0UjZXZk1nSDBRWmZLSE0xLWRpLXk5VEZSdHY2eV9fMHJiLVQtVzhhOW5zTkxfZ2dqbmFyODY0NjFxTzByT3MyY1hqcDNrT0cxRkVKNU1WbUZtQkd0bnJLcGE3M1hwWHlUcVJ4Ql9NMG4xbl9XOW5HcUM0RlNZYTA0VDZONVJJWkdCTjJ6Mk1UNUlLR2JGbGJDOFVyVzBEeFc3QVlJbVFRY0h0R2xfbTAwUUxWV3V0SFFvVkpZbkZQbFhUY0hZdkFTTHUtUmhoc2JEbXhNZ0pKMG1jRHB2c0M0UGp2Qi1UeHl3RWxnUzcwdkUwWG1MRC1PSnR2c0JzbEhadlBCS0NPZFQwTVMtdGdTT0lmZ2EtejFaMWc3LURWYWdmN3F1dm1hZzhqZlBpb3lLdnhuS19FZ3NUVVZpMmdoenE4d20yN3VkX21JTTdBWTJxRU9SUjhHbzNUVkI0SHpXUWdwWnJ0M2k1TUlsQ2FZNTA0THpTUmlpZ0hDekFQbEh3cy1XMHJCNU4tZXI1XzJwSktuZkJTRGlDaUZBVnRDTE9aN2dMaU1tMGpoTzJCNnRVWEhJXy1NUlBqeTAyaTU5bElOTVJSZXY1NkdLdGNkOXFPXzBrVUpXZFpUZEEyWG9TODJpeFB2WnRYUXBVcHVMMTJhYi05RWFESzhaNFJISllZZkNUM1E1dk5BWGFpV1EtOFBUV20yUWdCUl9ia3dTV2MtTnBVRmdOUE45UHZRaThXRWc1VW1BR01DQXdFQUFhT0JwakNCb3pBZEJnTlZIUTRFRmdRVU5tSGhBSHlJQlFsUmkwUnNSXzhhVE1ucVR4SXdId1lEVlIwakJCZ3dGb0FVTm1IaEFIeUlCUWxSaTBSc1JfOGFUTW5xVHhJd0R3WURWUjBUQVFIX0JBVXdBd0VCX3pBT0JnTlZIUThCQWY4RUJBTUNBWVl3UUFZRFZSMGZCRGt3TnpBMW9ET2dNWVl2YUhSMGNITTZMeTloYm1SeWIybGtMbWR2YjJkc1pXRndhWE11WTI5dEwyRjBkR1Z6ZEdGMGFXOXVMMk55YkM4d0RRWUpLb1pJaHZjTkFRRUxCUUFEZ2dJQkFDREl3NDFMM0tsWEcwYU1pU19fY3FyRy1FU2hIVUdvOEhOc3czMFcxa0p0am42VUJ3Uk02am5taXdmQlBiOFZBOTFjaGIydnNzQXRYMnpiVHZxQko5LUxCUEdDZHdfRTUzUmJmODZxaHhLYWlBSE9qcHZBeTVZM20wMG1xQzB3X1p3dmp1MXR3YjR2aExhSjVOa1VKWXNVUzdybUpLSEhCbkVUTGk4R0ZxaUVzcVRXcEdfNmliWUN2N3JZREJKRGNSOVc2MkJXOWpmSW9CUWN4VUNVSm91TVBIMjVsTE5jRGMxc3NxdkMydjdpVWdJOUxlb00xc05vdnFQbVFVaUc5ckhsaTF2WHh6Q3lhTVRqd2Z0a0pMa2Y2NzI0REZodUt1ZzJqSVRWMFFrWHZhSldGNG5VYUhPVE5BNHVKVTlXRHZaTEkxajgzQS1feG5BSlV1Y0l2X3pHSjFBTUgyYm9IcUY4Q1kxNkxwc1lnQnQ2dEt4eFdIMDBYY3lEQ2RXMktsQkNlcWJRUGNzRm1XeVd1Z3hkY2VraFlzQVd5b1NmODE4TlVzWmRCV0JhUl9PdWtYck5MZmtRNzlJeVpvaFpidmFiT19YLU1WVDNycmlBb0tjOG9FMlV3czZERi02MFBWN19XSVBqTnZYeVNkcXNwSW1TTjc4bWZseERxd0xxUkJZa0EzSTc1cXBwTEdHOXJwN1VDZFJqeE1sOFpEQmxkLTd5dkhWZ3QxY1Z6Sng5eG55R0NDMjNVYWljTURTWFlyQjRJNFdIWFBHanhoWnVDdVBCTFRkT0xVOFlSdk1ZZEV2WWViV0hNcHZ3R0NGNmJBeDNKQnBJZU9RMXdEQjV5MFVTaWNWM1lnWUdtaS1OWmZoQTRVUlNoNzdZZDZ1dUpPSkVOUmFOVlR6ayJdLCJrZXlBdHRlc3RhdGlvbiI6bnVsbCwiY2hhbGxlbmdlIjoiMHVMMklvRXdHYW9JN21qLU9Sc2tNS2ZaQkUwOTJaS0xGNWs3NUZUSjN6cyIsImNsaWVudERhdGEiOiJNRmt3RXdZSEtvWkl6ajBDQVFZSUtvWkl6ajBEQVFjRFFnQUVmcTZYSlZWQTJiYkpKZ0lrMjhLeEd5eUEtZ3htZUFKS0I3TXVuQklPUFdJUElQRGQ1Zmdmd1dTQUp1SzBoN3M3RGI5NlVjcXhlT3lSV3lLR1huQ3JkQSIsInZlcmlmaWNhdGlvblRpbWUiOiIyMDI1LTA0LTI4VDEwOjEzOjE0Ljg1MzI4MDI5MFoiLCJ2ZXJpZmljYXRpb25UaW1lT2Zmc2V0IjoiUFQwUyJ9".multibaseDecode()!!.decodeToString())
        println( statement           .replayKeyAttestationLegacy())
    }

    "Given an X509-encoded key" - {
        val x509Key =
            "MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEFT1XwEeF8NftY84GfnqTFBoxHNkdG7wZHcOkLKwT4W6333Jqmga1XkKySq/ApnslBPNZE1Os363SAv8X85ZIrQ==".decodeBase64ToArray()
        "it should be parsable" - {
            val parsedKey = x509Key.parseToPublicKey()
            "and encodable to ANSI X9.62" - {
                val ansiBytes = parsedKey.toCryptoPublicKey().getOrThrow().iosEncoded
                "and decodable" - {
                    val decoded = ansiBytes.parseToPublicKey()
                    "to match the original X5095-encoded key" {
                        decoded.encoded shouldBe x509Key
                    }
                }
            }
        }
    }
})